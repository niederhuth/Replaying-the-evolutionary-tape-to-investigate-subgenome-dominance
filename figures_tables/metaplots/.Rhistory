nrow(syn)-nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])),
nonsyntenic=c(59225-nrow(syn),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="TO1000",]),
(59225-nrow(syn))-nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="TO1000",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="Cabbage",]),
(59225-nrow(syn))-nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="Cabbage",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",]),
(59225-nrow(syn))-nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",]))
)
synDEG <- data.frame(
row.names=c("Genome","KvT DEG","KvT Non-DEG",
"KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
syntenic=c(nrow(syn),
nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Kale" & sig$sampleB=="TO1000",]),
nrow(syn)-nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Kale" & sig$sampleB=="TO1000",]),
nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Kale" & sig$sampleB=="Cabbage",]),
nrow(syn)-nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Kale" & sig$sampleB=="Cabbage",]),
nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",]),
nrow(syn)-nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])),
nonsyntenic=c(59225-nrow(syn),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="TO1000",]),
(59225-nrow(syn))-nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="TO1000",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="Cabbage",]),
(59225-nrow(syn))-nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Kale" & sig$sampleB=="Cabbage",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",]),
(59225-nrow(syn))-nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",]))
)
synDEG
fisher.test(as.matrix(synDEG[c(2:3),]))
fisher.test(as.matrix(synDEG[c(4:5),]))
fisher.test(as.matrix(synDEG[c(6:7),]))
fisher.test(as.matrix(synDEG[c(2:3),c(2,1)]))
fisher.test(as.matrix(synDEG[c(4:5),c(2,1)]))
fisher.test(as.matrix(synDEG[c(6:7),c(2,1)]))
synDEG[c(2:3),]
synDEG[c(2:3),c(2,1)]\
synDEG[c(2:3),c(2,1)]
fisher.test(as.matrix(synDEG[c(2:3),c(2,1)]))
fisher.test(as.matrix(synDEG[c(2:3),]))
fisher.test(as.matrix(synDEG[c(2:3),]),alternative="two.sided")
fisher.test(as.matrix(synDEG[c(2:3),]),alternative="two.sided")
fisher.test(as.matrix(synDEG[c(4:5),]),alternative="two.sided")
fisher.test(as.matrix(synDEG[c(6:7),]),alternative="two.sided")
fisher.test(as.matrix(synDEG[c(2:3),c(2,1)]),alternative="two.sided")
fisher.test(as.matrix(synDEG[c(4:5),c(2,1)]),alternative="two.sided")
fisher.test(as.matrix(synDEG[c(6:7),c(2,1)]),alternative="two.sided")
KvCsub
test2 <- data.frame(
row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(10763,1463,9300,1472,9291,1502,9261),
nonLF=c(48462,6652,41810,5872,42590,5526,42936),
MF1=c(7420,1120,6300,1121,6299,1099,6321),
nonMF1=c(51805,6995,44810,6223,45582,5929,45876),
MF2=c(6338,936,5402,876,5462,913,5425),
nonMF2=c(52887,7179,45708,6468,46419,6115,46772))
test2
trest2
test2
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",])
nrow(syn)
head(syn)
c(nrow(syn[syn$subgenome=="LF",])
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="T01000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF"])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF"])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF"])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))
nrow(syn[syn$subgenome=="LF"])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])
c(nrow(syn[syn$subgenome=="LF",])
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="T01000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))
c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="T01000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="T01000" & synSig$subgenome=="LF",])
c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))
test2
nrow(sig)
head(sig)
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))
),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))
c(59225-nrow(syn[syn$subgenome=="LF",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])))
subDEG <- data.frame(row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG",
"KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nonLF=c(59225-nrow(syn[syn$subgenome=="LF",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))),
MF1=c(nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])),
nonMF1=c(c(59225-nrow(syn[syn$subgenome=="MF1",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]))),
MF2=c(nrow(syn[syn$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])),
nonMF2=c(c(59225-nrow(syn[syn$subgenome=="MF2",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]))),
)
subDEG <- data.frame(row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG",
"KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nonLF=c(59225-nrow(syn[syn$subgenome=="LF",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))),
MF1=c(nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])),
nonMF1=c(c(59225-nrow(syn[syn$subgenome=="MF1",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]))),
MF2=c(nrow(syn[syn$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])),
nonMF2=c(c(59225-nrow(syn[syn$subgenome=="MF2",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])))
)
subDEG <- data.frame(row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG",
"KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="LF",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nonLF=c(59225-nrow(syn[syn$subgenome=="LF",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="LF",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
(59225-nrow(syn[syn$subgenome=="LF",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]))),
MF1=c(nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])),
nonMF1=c(59225-nrow(syn[syn$subgenome=="MF1",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF1",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
(59225-nrow(syn[syn$subgenome=="MF1",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]))),
MF2=c(nrow(syn[syn$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
nrow(syn[syn$subgenome=="MF2",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])),
nonMF2=c(59225-nrow(syn[syn$subgenome=="MF2",]),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])),
nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Kale" & sig$sampleB=="Cabbage",])-nrow(synSig[synSig$sampleA=="Kale" & synSig$sampleB=="Cabbage" & synSig$subgenome=="MF2",])),
nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]),
(59225-nrow(syn[syn$subgenome=="MF2",]))-(nrow(sig[sig$sampleA=="Cabbage" & sig$sampleB=="TO1000",])-nrow(synSig[synSig$sampleA=="Cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])))
)
subDEG
FEsubDEG <- data.frame(
row.names=c("KvT","KvC","CvT"),
LF_pvalue=c(
fisher.test(as.matrix(test2[c(2:3),c(1,2)]))$p.value,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]))$p.value,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]))$p.value),
LF_OR=c(
fisher.test(as.matrix(test2[c(2:3),c(1,2)]))$estimate,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]))$estimate,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]))$estimate),
MF1_pvalue=c(
fisher.test(as.matrix(test2[c(2:3),c(3,4)]))$p.value,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]))$p.value,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]))$p.value),
MF1_OR=c(
fisher.test(as.matrix(test2[c(2:3),c(3,4)]))$estimate,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]))$estimate,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]))$estimate),
MF2_pvalue=c(
fisher.test(as.matrix(test2[c(2:3),c(5,6)]))$p.value,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]))$p.value,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]))$p.value),
MF2_OR=c(
fisher.test(as.matrix(test2[c(2:3),c(5,6)]))$estimate,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]))$estimate,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]))$estimate)
)
FEsubDEG
library(VennDiagram)
tmp <- synRes[synRes$sampleA=="Kale" & synRes$sampleB=="TO1000",]
tmp$direction <- ifelse(tmp$log2FC > 0 & tmp$padj < 0.05,1,ifelse(tmp$log2FC < 0 & tmp$padj < 0.05,-1,0))
tmp2 <- tmp[tmp$direction != 0,]$At_gene
tmp2 <- as.vector(unique(tmp[tmp$direction != 0,]$At_gene))
tmp3 <- tmp[tmp$At_gene %in% tmp2,]
tmp4 <- tmp[,c(10,9,11)]
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$subgenome))
tmp5$sum <- rowSums(tmp5)
tmp6 <- as.vector(row.names(tmp5[tmp5$sum != tmp5$LF & tmp5$sum != tmp5$MF1 & tmp5$sum != tmp5$MF2,]))
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$direction))
tmp5 <- tmp5[row.names(tmp5) %in% as.vector(unique(tmp$At_gene)),]
#tmp5 <- tmp5[row.names(tmp5) %in% tmp2,]
tmp5$sum <- rowSums(tmp5)
tmp7 <- tmp5[tmp5$sum > 1 & row.names(tmp5) %in% tmp6,]
tmp6 <- row.names(tmp5[tmp5$`1` > 0 & tmp5$`-1` > 0,])
Bidirectional <- tmp[tmp$At_gene %in% tmp6,]
tmp6 <- row.names(tmp5[tmp5$sum == 1 & tmp5$`1` > 0,])
single_up <- tmp[tmp$At_gene %in% tmp6,]
tmp6 <- row.names(tmp5[tmp5$sum == 1 & tmp5$`-1` > 0,])
single_down <- tmp[tmp$At_gene %in% tmp6,]
tmp6 <- row.names(tmp5[tmp5$sum == 1,])
single_copy <- tmp[tmp$At_gene %in% tmp6,]
draw.triple.venn(area1=nrow(tmp7[tmp7$`-1`> 0,]),
area2=nrow(tmp7[tmp7$`1`> 0,]),
area3=nrow(tmp7[tmp7$`0`> 0,]),
n12=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0,]),
n23=nrow(tmp7[tmp7$`1`> 0 & tmp7$`0`> 0,]),
n13=nrow(tmp7[tmp7$`0`> 0 & tmp7$`-1`> 0,]),
n123=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0 & tmp7$`0`> 0,]),
category = c("Lower Expression", "Higher Expression", "No Difference"),
lty = "blank",
fill = c("skyblue", "pink1", "mediumorchid")
)
head(tmp3)
head(tmp4)
head(tmp5)
row.names(tmp5[tmp5$sum != tmp5$LF & tmp5$sum != tmp5$MF1 & tmp5$sum != tmp5$MF2,])
head(tmp6)
tmp6
head(tmp6)
tmp5
tmp5$LF
tmp5$LF
head(tmp5)
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$subgenome))
head(tmp5)
table(tmp5)
colSums(tmp5)
tmp7 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$direction))
tmp7 <- tmp7[row.names(tmp5) %in% as.vector(unique(tmp$At_gene)),]
#tmp5 <- tmp5[row.names(tmp5) %in% tmp2,]
tmp7$sum <- rowSums(tmp7)
head(tmp7)
head tmp5
head(tmp5)
nrow(tmp5[tmp5$LF>0 & tmp5$MF1>0 & tmp5$MF2>0,])
tmp7[row.names(tmp7) %in% row.names(tmp5[tmp5$LF>0 & tmp5$MF1>0 & tmp5$MF2>0,]),]
tmp8 <- tmp7[row.names(tmp7) %in% row.names(tmp5[tmp5$LF>0 & tmp5$MF1>0 & tmp5$MF2>0,]),]
table(tmp8[1:3])
ls
nrow(tmp8[tmp8$`-1`<1 & tmp8$`0`<1 & tmp8$`1`>1,])
nrow(tmp8[tmp8$`-1`<1 & tmp8$`0`<1 & tmp8$`1`>0,])
nrow(tmp8[tmp8$`-1`<1 & tmp8$`0`>1 & tmp8$`1`>1,])
nrow(tmp8[tmp8$`-1`<1 & tmp8$`0`<1 & tmp8$`1`<1,])
nrow(tmp8[tmp8$`-1`<1 & tmp8$`0`>1 & tmp8$`1`<1,])
Bidirectional
nrow(Bidirectional)
nrow(tmp8[tmp8$`-1`>1 & tmp8$`0`>1 & tmp8$`1`>1,])
nrow(tmp8[tmp8$`-1`>0 & tmp8$`0`>0 & tmp8$`1`>0,])
nrow(tmp8[tmp8$`-1`>0 & tmp8$`0`<1 & tmp8$`1`>0,])
nrow(tmp8[tmp8$`-1`>0 & tmp8$`0`>1 & tmp8$`1`>0,])
nrow(tmp8[tmp8$`-1`>1 & tmp8$`0`>1 & tmp8$`1`>0,])
nrow(tmp8[tmp8$`-1`>1 & tmp8$`0`>1 & tmp8$`1`<1,])
nrow(tmp8[tmp8$`-1`<1 & tmp8$`0`>0 & tmp8$`1`>0,])
tmp8[tmp8$`-1`<1 & tmp8$`0`>0 & tmp8$`1`>0,]
library(scales)
library(flextable)
p.adjust(method="BH")
FEsubDEG <- data.frame(
row.names=c("KvT","KvC","CvT"),
LF_pvalue=c(
fisher.test(as.matrix(test2[c(2:3),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]),alternative="two.sided")$p.value),
LF_OR=c(
fisher.test(as.matrix(test2[c(2:3),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]),alternative="two.sided")$estimate),
MF1_pvalue=c(
fisher.test(as.matrix(test2[c(2:3),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]),alternative="two.sided")$p.value),
MF1_OR=c(
fisher.test(as.matrix(test2[c(2:3),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]),alternative="two.sided")$estimate),
MF2_pvalue=c(
fisher.test(as.matrix(test2[c(2:3),c(5,6)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]),alternative="two.sided")$p.value),
MF2_OR=c(
fisher.test(as.matrix(test2[c(2:3),c(5,6)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]),alternative="two.sided")$estimate)
)
FEsubDEG
FEsubDEG <- data.frame(
row.names=c("Kale vs TO1000 LF","Kale vs TO1000 MF1","Kale vs TO1000 MF2",
"Kale vs Cabbage LF","Kale vs Cabbage MF1","Kale vs Cabbage MF2",
"Cabbage vs TO1000 LF","Cabbage vs TO1000 MF1","Cabbage vs TO1000 MF2"),
pvalue=c(fisher.test(as.matrix(test2[c(2:3),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(2:3),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(2:3),c(5,6)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]),alternative="two.sided")$p.value),
OR=c(fisher.test(as.matrix(test2[c(2:3),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(2:3),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(2:3),c(5,6)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]),alternative="two.sided")$estimate)
)
FEsubDEG
FEsubDEG$p.adjust <- p.adjust(FEsubDEG$pvalue,method="BH")
FEsubDEG
FEsubDEG <- data.frame(
row.names=c("Kale vs TO1000 LF","Kale vs TO1000 MF1","Kale vs TO1000 MF2",
"Kale vs Cabbage LF","Kale vs Cabbage MF1","Kale vs Cabbage MF2",
"Cabbage vs TO1000 LF","Cabbage vs TO1000 MF1","Cabbage vs TO1000 MF2"),
OR=c(fisher.test(as.matrix(test2[c(2:3),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(2:3),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(2:3),c(5,6)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]),alternative="two.sided")$estimate,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]),alternative="two.sided")$estimate),
pvalue=c(fisher.test(as.matrix(test2[c(2:3),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(1,2)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(2:3),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(3,4)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(2:3),c(5,6)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(4:5),c(5,6)]),alternative="two.sided")$p.value,
fisher.test(as.matrix(test2[c(6:7),c(5,6)]),alternative="two.sided")$p.value)
)
FEsubDEG$p.adjust <- p.adjust(FEsubDEG$pvalue,method="BH")
FEsubDEG
FEsubDEG
save.image("~/Analysis/Boleracea-rnaseq/figures_tables/Analysis.RData")
ls()
library(V.PhyloMaker)
detach(V.PhyloMaker)
detach(package="V.PhyloMaker")
detach(name="V.PhyloMaker")
detach(name=V.PhyloMaker)
detach("package:V.PhyloMaker", unload = TRUE)
detach("package:ape", unload = TRUE)
load("~/Analysis/Boleracea-rnaseq/figures_tables/Analysis.RData")
library(ggplot2)
nrow(Kshared)
library(reshape2)
library(ggplot2)
library(scales)
setwd("projects/Bnapus-polyploid/figures_tables/")
samples <- read.csv('../misc/samples.csv',header=T)
plots <- c('all_genes')
controls <- c("TO1000","R500","mock")
setwd("metaplots/")
df1 <- matrix(nrow=0,ncol=0)
for(x in plots){
for(i in samples$Sample){
input=paste(x,paste(i,x,"metaplot.txt.gz",sep="_"),sep="/")
if(file.exists(input)){
df2 <- read.table(input,header=T,sep="\t")[2:4]
colnames(df2) <- c('CG','CHG','CHH')
df2$sample <- c(i)
df2 <- melt(df2)
df2$generation <- c(as.character(samples[samples$Sample==i,]$Generation))
df1 <- rbind(df1,df2)
rm(df2)
} else {
next
}
}
df1$window <- c(1:60)
for(y in c("G1","G5","G10")){
sample_list <- c(y,controls)
plot <- ggplot(df1[df1$variable=="CG" & df1$generation %in% sample_list,]) +
geom_line(aes(x=window,y=value,color=generation,group=sample),size=1) +
theme(panel.background=element_blank(),panel.grid=element_blank(),
axis.text.y=element_text(color="black"),axis.text.x=element_text(color="black"),
axis.ticks=element_line(color="black"),axis.title=element_text(color="black"),
legend.position="right",axis.line=element_line(color="black")) +
ylab("Percent methylation") + xlab("") +
scale_y_continuous(limits=c(0,0.6),expand=c(0,0),breaks=c(0.2,0.4,0.6),
labels=c("20%","40%","60%")) +
geom_vline(xintercept=20,linetype="longdash",color="grey55") +
geom_vline(xintercept=40,linetype="longdash",color="grey55") +
scale_x_continuous(labels=c("-2000","TSS'","TTS'","+2000"),breaks=c(1, 20, 40, 60)) +
scale_color_manual("",values=c("violetred2","black","dodgerblue3","cyan3"))
ggsave(paste(x,y,"CG_metaplot.pdf",sep="_"),plot,path="new_plots/")
plot <- ggplot(df1[df1$variable=="CHG" & df1$generation %in% sample_list,]) +
geom_line(aes(x=window,y=value,color=generation,group=sample),size=1) +
theme(panel.background=element_blank(),panel.grid=element_blank(),
axis.text.y=element_text(color="black"),axis.text.x=element_text(color="black"),
axis.ticks=element_line(color="black"),axis.title=element_text(color="black"),
legend.position="right",axis.line=element_line(color="black")) +
ylab("Percent methylation") + xlab("") +
scale_y_continuous(limits=c(0,0.3),expand=c(0,0),breaks=c(0.1,0.2,0.3),
labels=c("10%","20%","30%")) +
geom_vline(xintercept=20,linetype="longdash",color="grey55") +
geom_vline(xintercept=40,linetype="longdash",color="grey55") +
scale_x_continuous(labels=c("-2000","TSS'","TTS'","+2000"),breaks=c(1, 20, 40, 60)) +
scale_color_manual("",values=c("violetred2","black","dodgerblue3","cyan3"))
ggsave(paste(x,y,"CHG_metaplot.pdf",sep="_"),plot,path="new_plots/")
plot <- ggplot(df1[df1$variable=="CHH" & df1$generation %in% sample_list,]) +
geom_line(aes(x=window,y=value,color=generation,group=sample),size=1) +
theme(panel.background=element_blank(),panel.grid=element_blank(),
axis.text.y=element_text(color="black"),axis.text.x=element_text(color="black"),
axis.ticks=element_line(color="black"),axis.title=element_text(color="black"),
legend.position="right",axis.line=element_line(color="black")) +
ylab("Percent methylation") + xlab("") +
scale_y_continuous(limits=c(0,0.075),expand=c(0,0),breaks=c(0.025,0.05,0.075),
labels=c("2.5%","5.0%","7.5%")) +
geom_vline(xintercept=20,linetype="longdash",color="grey55") +
geom_vline(xintercept=40,linetype="longdash",color="grey55") +
scale_x_continuous(labels=c("-2000","TSS'","TTS'","+2000"),breaks=c(1, 20, 40, 60)) +
scale_color_manual("",values=c("violetred2","black","dodgerblue3","cyan3"))
ggsave(paste(x,y,"CHH_metaplot.pdf",sep="_"),plot,path="new_plots/")
}
}
